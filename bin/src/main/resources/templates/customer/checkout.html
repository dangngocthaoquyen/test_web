<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org"
	xmlns:layout="http://www.ultraq.net.nz/thymeleaf/layout"
	layout:decorate="~{customer/layout}">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Thanh to√°n</title>

<th:block layout:fragment="styles">
	<link rel="stylesheet" href="/styles/css/customer/base.css">
	<link rel="stylesheet" href="/styles/css/customer/checkout.css">
</th:block>
</head>
<body>
	<div layout:fragment="content" class="checkout-container">

		<!-- ====== ƒê·ªäA CH·ªà NH·∫¨N H√ÄNG ====== -->
		<section class="address-section">
			<div class="address-header">
				<i class="fa fa-location-dot"></i>
				<h3>ƒê·ªãa ch·ªâ nh·∫≠n h√†ng</h3>
			</div>
			<div class="address-info">
				<p class="receiver">
					<span class="name" th:text="${customer.hoTen}">Thu Trang</span> (<span
						class="phone" th:text="${customer.sdt}">+84 943 276 245</span>)
				</p>
				<p class="address" th:text="${customer.diaChi}">S·ªë 22C, L√†ng
					TƒÉng Ph√∫, Ph∆∞·ªùng TƒÉng Nh∆°n Ph√∫ A, TP. Th·ªß ƒê·ª©c, TP.HCM</p>
				<a href="#" class="change-btn">Thay ƒë·ªïi</a>
			</div>
		</section>

		<!-- ====== DANH S√ÅCH S·∫¢N PH·∫®M ====== -->
		<section class="cart-section">
			<h3>S·∫£n ph·∫©m</h3>
			<table class="cart-table">
				<thead>
					<tr>
						<th>S·∫£n ph·∫©m</th>
						<th>ƒê∆°n gi√°</th>
						<th>S·ªë l∆∞·ª£ng</th>
						<th>Th√†nh ti·ªÅn</th>
					</tr>
				</thead>
				<tbody th:if="${cartItems != null}">
					<tr th:each="item : ${cartItems}">
						<td class="product-info"><img
							th:src="@{/styles/image/product/{file}(file=${item.sanPham.hinhAnh})}"
							alt="·∫¢nh s·∫£n ph·∫©m"></td>
						<td class="p-name" th:text="${item.sanPham.tenSP}"></td>
						<td
							th:text="${#numbers.formatDecimal(item.sanPham.gia, 0, 'COMMA', 0, 'POINT')} + ' ‚Ç´'"></td>
						<td th:text="${item.soLuong}"></td>
						<td
							th:text="${#numbers.formatDecimal(item.tongTien, 0, 'COMMA', 0, 'POINT')} + ' ‚Ç´'"></td>

					</tr>
				</tbody>
			</table>

			<div class="cart-summary">
				<p>
					T·ªïng ti·ªÅn (<span
						th:text="${cartItems != null ? #lists.size(cartItems) : 0}">2</span>
					s·∫£n ph·∫©m): <strong
						th:text="${#numbers.formatDecimal(total, 0, 'COMMA', 0, 'POINT')} + ' ‚Ç´'">350.000
						‚Ç´</strong>
				</p>
			</div>
		</section>

		<!-- ====== PH∆Ø∆†NG TH·ª®C THANH TO√ÅN ====== -->
		<section class="payment-section">
			<h3>Ph∆∞∆°ng th·ª©c thanh to√°n</h3>
			<div class="payment-options">
				<label class="payment-tab active"> <input type="radio"
					name="paymentMethod" value="COD" checked> <img
					src="/styles/image/icons/cod.png" alt="COD"> <span>Thanh
						to√°n khi nh·∫≠n h√†ng (Ship COD)</span>
				</label> <label class="payment-tab"> <input type="radio"
					name="paymentMethod" value="QR"> <img
					src="/styles/image/icons/qr.png" alt="QR"> <span>Thanh
						to√°n Online (Qu√©t m√£ QR)</span>
				</label>
			</div>

			<div class="qr-box" id="qrBox">
				<p>Vui l√≤ng qu√©t m√£ QR ƒë·ªÉ thanh to√°n:</p>
				<img src="/styles/image/payment/qr-demo.png" alt="M√£ QR Thanh to√°n">
				<p class="qr-note">Sau khi qu√©t, ƒë∆°n h√†ng s·∫Ω ƒë∆∞·ª£c x√°c nh·∫≠n t·ª±
					ƒë·ªông üå∏</p>
			</div>

			<!-- ====== T·ªîNG K·∫æT ====== -->
			<div class="payment-summary">
				<div class="summary-line">
					<span>T·ªïng ti·ªÅn h√†ng</span> <span
						th:text="${#numbers.formatDecimal(total, 0, 'COMMA', 0, 'POINT')} + ' ‚Ç´'">350.000
						‚Ç´</span>
				</div>
				<div class="summary-line">
<<<<<<< HEAD
					<span>Ph√≠ v·∫≠n chuy·ªÉn</span> <span>20.000 ‚Ç´</span>
				</div>
				<div class="summary-line total">
					<span>T·ªïng thanh to√°n</span> <strong
						th:text="${#numbers.formatDecimal(total.doubleValue() + 20000, 0, 'COMMA', 0, 'POINT')} + ' ‚Ç´'">370.000
=======
					<span>Ph√≠ v·∫≠n chuy·ªÉn</span> <span
						th:text="${#numbers.formatDecimal(shippingFee,0,'COMMA',0,'POINT')} + ' ‚Ç´'"></span>
				</div>
				<div class="summary-line total">
					<span>T·ªïng thanh to√°n</span> <strong
						th:text="${#numbers.formatDecimal(grandTotal.doubleValue(), 0, 'COMMA', 0, 'POINT')} + ' ‚Ç´'">370.000
>>>>>>> fa4535467b378296a1ee459fed9d873ec68045a1
						‚Ç´</strong>
				</div>

				<form th:action="@{/checkout/confirm}" method="post">
					<input type="hidden" name="tenNguoiNhan"
						th:value="${customer.hoTen}"> <input type="hidden"
						name="sdt" th:value="${customer.sdt}"> <input
						type="hidden" name="diaChi" th:value="${customer.diaChi}">
					<input type="hidden" name="paymentMethod" id="paymentMethodInput"
						value="COD">
					<button type="submit" class="btn-order">ƒê·∫∑t h√†ng</button>
				</form>
			</div>
		</section>

	</div>

	<th:block layout:fragment="scripts">
		<script>
    document.addEventListener("DOMContentLoaded", () => {
      const tabs = document.querySelectorAll(".payment-tab");
      const qrBox = document.getElementById("qrBox");
      const methodInput = document.getElementById("paymentMethodInput");

      tabs.forEach(tab => {
        tab.addEventListener("click", () => {
          tabs.forEach(t => t.classList.remove("active"));
          tab.classList.add("active");
          const val = tab.querySelector("input").value;
          methodInput.value = val;
          qrBox.style.display = val === "QR" ? "block" : "none";
        });
      });
    });
  </script>
		<script src="/styles/js/customer/header.js"></script>
		<script th:src="@{/styles/js/customer/product.js}"></script>
		<script th:src="@{/styles/js/chat.js}"></script>
	</th:block>
</body>
</html>
