<!DOCTYPE html>
<html lang="vi" xmlns:th="http://www.thymeleaf.org">
<head>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width, initial-scale=1" />
<title>Quản lý khách hàng</title>

<link rel="stylesheet" href="/styles/css/manager/header.css" />
<link rel="stylesheet" href="/styles/css/manager/sidebar.css" />
<link rel="stylesheet" href="/styles/css/manager/main.css" />

<link rel="stylesheet"
	href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.0/css/all.min.css" />
</head>
<body>
	<div th:insert="~{manager/fragments/header :: header}"></div>

	<main class="main-content show">
		<div th:insert="~{manager/fragments/sidebar :: sidebar}"></div>

		<!-- templates/manager/customer/list.html -->
<section class="page-header">
 <a class="btn outline"
   th:href="@{/manager/customers/export(q=${q},month=${month},year=${year})}">
  <i class="fa fa-file-export"></i> Xuất file
</a>

</section>

<!-- Cards: Tổng KH -->
<section class="grid cards">
  <div class="card">
    <div class="title">Tổng số khách hàng</div>
    <span th:text="${stats.tongKhachHang}">0</span>

  </div>
</section>

<!-- Search + Filters -->
<form method="get" class="filters">
  <div class="field" style="flex:1">
    <label>Tìm kiếm</label>
    <input type="text" name="q" th:value="${q}" placeholder="Tên, SĐT hoặc Email..."/>
  </div>
  <div class="field">
    <label>Tháng</label>
    <select name="month">
      <option th:value="${null}" th:selected="${month==null}">Tất cả</option>
      <option th:each="m : ${#numbers.sequence(1,12)}"
              th:value="${m}" th:selected="${m==month}" th:text="${m}"></option>
    </select>
  </div>
  <div class="field">
    <label>Năm</label>
    <input type="number" name="year" th:value="${year}" placeholder="VD: 2025"/>
  </div>
  <button class="btn" type="submit"><i class="fa fa-filter"></i> Lọc</button>
</form>

<!-- Bảng -->
<section class="card">
  <div class="card-body">
    <table class="table">
      <thead>
      <tr>
        <th>STT</th><th>Tên</th><th>SĐT</th><th>Email</th><th>Tổng đơn</th><th>Ngày tạo</th>
        <th class="center">Hành động</th>
      </tr>
      </thead>
      <tbody>
      <tr th:each="r, idx : ${rows}">
        <td th:text="${idx.count}">1</td>
        <td th:text="${r.hoTen()}">-</td>
        <td th:text="${r.sdt()}">-</td>
        <td th:text="${r.email()}">-</td>
        <td th:text="${r.tongDon()}">0</td>
        <td th:text="${r.ngayTao()}">--/--/----</td>
        <td class="center">
          <a class="icon" th:href="@{|/manager/customers/${r.maKH()}|}" title="Chi tiết"><i class="fa fa-eye"></i></a>
          <a class="icon" th:href="@{|/manager/customers/${r.maKH()}/edit|}" title="Sửa"><i class="fa fa-pen"></i></a>
        </td>
      </tr>
      <tr th:if="${#lists.isEmpty(rows)}">
        <td colspan="7" class="empty">Không có dữ liệu</td>
      </tr>
      </tbody>
    </table>
  </div>
</section>
